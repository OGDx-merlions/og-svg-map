{"version":3,"sources":["og-svg-map.es6.js"],"names":["Polymer","is","behaviors","IronResizableBehavior","listeners","properties","width","type","String","value","height","observer","contextPaneProportion","Number","isUpstreamVisible","Boolean","isMidstreamVisible","isDownstreamVisible","isPredictiveVisible","attached","contextPaneOpen","d3","Px","svg","select","zoomControl","zoom","scaleExtent","on","attr","event","transform","mapZoomArea","style","call","_addContextualListeners","toggleContextPane","currHeightNum","replace","cpMinHeightPercentage","mapHeightPercentage","newMapHeight","Math","ceil","contextPaneMinHeight","defaultHeight","contextPaneMaxHeight","closeContextPane","invalidateSize","$","map","_showAll","selector","querySelectorAll","forEach","elt","display","_hideAll","_toggleGroup","_stateName","_selector","_pressedCls","undefined","_toggleUpstream","_toggleMidstream","_toggleDownstream","_togglePredictive","_compute","_adjustFilterVerticalMargin","newHeight","oldHeight","_onIronResize","_zoomIn","scaleBy","transition","duration","_zoomOut","listen","_gotoDefaultLocation","zoomIdentity","_openContextPane","fire","contextFragment","currentTarget","classList"],"mappings":"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","file":"og-svg-map.js","sourcesContent":["(function() {\n  Polymer({\n\n    is: 'og-svg-map', \n\n    behaviors: [Polymer.IronResizableBehavior],\n\n    listeners: {\n      'iron-resize': '_onIronResize'\n    },\n\n    properties: {\n      /**\n       * Component width\n       * \n       * @type {String}\n       */\n      width: {\n        type: String,\n        value: '75vw'\n      },\n      /**\n      * Component Height\n      * \n      * @type {String}\n      */\n      height: {\n        type: String,\n        value: '500px',\n        observer: '_adjustFilterVerticalMargin'\n      },\n      /**\n       * Proportion of contextual pane to the whole window\n       * Must be less than 1.\n       * @type {Number}\n       */\n      contextPaneProportion: {\n        type: Number,\n        value: 0.35\n      },\n      isUpstreamVisible: {\n        type: Boolean,\n        value: true\n      },\n      isMidstreamVisible: {\n        type: Boolean,\n        value: true\n      },\n      isDownstreamVisible: {\n        type: Boolean,\n        value: true\n      },\n      isPredictiveVisible: {\n        type: Boolean,\n        value: true\n      }\n    },\n\n    attached() {\n      this.contextPaneOpen = false;\n      const d3 = Px.d3;\n      this.svg  = d3.select(\"#map svg\");\n      this.zoomControl = d3.zoom()\n        .scaleExtent([1, 5])\n        .on(\"zoom\", () => {\n          this.svg.attr(\"transform\", d3.event.transform);\n      });\n      this.mapZoomArea = this.svg\n        .attr(\"fill\", \"none\")\n        .attr(\"pointer-events\", \"all\")\n        .attr(\"width\", \"100%\")\n        .attr(\"height\", \"100%\")\n        .style(\"cursor\", \"grab\")\n        .call(this.zoomControl);\n      this._addContextualListeners();\n    },\n\n    toggleContextPane() {\n      const currHeightNum = this.height.replace(/\\D/g, '');\n      const cpMinHeightPercentage = this.contextPaneProportion;\n      const mapHeightPercentage = (1 - cpMinHeightPercentage);\n      if(!this.contextPaneOpen) {\n        const newMapHeight = Math.ceil(currHeightNum * mapHeightPercentage);\n        this.height = this.height.replace(currHeightNum, newMapHeight);\n        this.contextPaneMinHeight = Math.ceil(currHeightNum * cpMinHeightPercentage);\n        this.contextPaneOpen = true;\n      } else {\n        this.height = this.defaultHeight;\n        this.contextPaneMinHeight = 0;\n        this.contextPaneMaxHeight = 0;\n        this.contextPaneOpen = false;\n      }\n    },\n\n    closeContextPane() {\n      if(this.contextPaneOpen) {\n        this.toggleContextPane();\n      }\n    },\n\n    invalidateSize() {\n      this.$.map.invalidateSize();\n    },\n    _showAll(selector) {\n      this.querySelectorAll(selector).forEach((elt) => {\n        elt.style.display = 'block';\n      });\n    },\n    _hideAll(selector) {\n      this.querySelectorAll(selector).forEach((elt) => {\n        elt.style.display = 'none';\n      });\n    },\n    _toggleGroup(_stateName, _selector, _pressedCls) {\n      if(this[_stateName]) {\n        this._hideAll(_selector);\n        this[_pressedCls] = 'pressed';\n      } else {\n        this._showAll(_selector);\n        this[_pressedCls] = undefined;\n      }\n      this[_stateName] = !this[_stateName];\n    },\n    _toggleUpstream() {\n      this._toggleGroup('isUpstreamVisible', \n        '.upstream', 'upstreamPressedCls');\n    },\n    _toggleMidstream() {\n      this._toggleGroup('isMidstreamVisible', \n        '.midstream', 'midstreamPressedCls');\n    },\n    _toggleDownstream() {\n      this._toggleGroup('isDownstreamVisible', \n        '.downstream', 'downstreamPressedCls');\n    },\n    _togglePredictive() {\n      this._toggleGroup('isPredictiveVisible', \n        '.predictive', 'predictivePressedCls');\n    },\n    _compute(contextPaneOpen) {\n      return !contextPaneOpen;\n    },\n    _adjustFilterVerticalMargin(newHeight, oldHeight) {\n      if(!oldHeight) {\n        this.defaultHeight = newHeight;\n      }\n    },\n    _onIronResize() {},\n    _zoomIn() {\n      this.zoomControl.scaleBy(\n        this.mapZoomArea.transition().duration(500), 1.3);\n    },\n    _zoomOut() {\n      this.zoomControl.scaleBy(\n        this.mapZoomArea.transition().duration(500), 1 / 1.3);\n    },\n    _addContextualListeners() {\n      this.querySelectorAll('.contextual').forEach((elt) => {\n        this.listen(elt, 'tap', '_openContextPane');\n      });\n    },\n    _gotoDefaultLocation() {\n      this.mapZoomArea.transition()\n        .duration(750)\n        .call(this.zoomControl.transform, Px.d3.zoomIdentity);\n    },\n    /**\n    * Fires event when a class named `contextual` is tapped\n    *\n    *   * {Object} event - Contains the event details\n    *   * {Element} contextFragment - Target on which the tap event occured\n    *   * {Array} classList - Classes on the tapped element\n    *\n    * @event contextual-tapped\n    */\n    _openContextPane(event) {\n      if(!this.contextPaneOpen) {\n        this.toggleContextPane();\n      }\n      this.fire('contextual-tapped', {\n        event: event, \n        contextFragment: event.currentTarget,\n        classList: event.currentTarget.classList\n      });\n    }\n  });\n})();\n"]}